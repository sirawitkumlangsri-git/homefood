import{u as y,K as x,r as m,o as h,g,J as k,A as p,t as r,L as l,v as c,x as t,M as i,N as f,O as N,z as U,B as V,P as _}from"./BLO-2kdC.js";import j from"./B2iBkU6z.js";import".prisma/client/index-browser";import"./DHYx5gbp.js";const B={key:0,class:"text-center"},E={key:1,class:"flex justify-center p-4"},L={class:"form-control w-full mt-3"},M={class:"form-control w-full mt-3"},R={class:"form-control w-full"},T={class:"flex sm:justify-end justify-center gap-5"},A={__name:"[id]",setup(C){const b=y(),u=x(),d=m(!0),s=m({email:"",role:"",fullname:"",phoneNumber:""}),w=async o=>{try{const e=await fetch(`/api/admin/user/${o}`,{method:"GET"});if(!e.ok)throw new Error(`แสดงข้อมูลผู้ใช้ไม่สำเร็จ status : ${e.status}`);const a=await e.json();s.value={email:a.email,role:a.role,fullname:a.fullname,phoneNumber:a.phoneNumber}}catch(e){console.error("แสดงข้อมูลผู้ใช้ไม่สำเร็จ:",e)}finally{d.value=!1}};h(async()=>{const o=u.params.id;console.log("Route ID:",o),o&&await w(o),console.log("form : ",s.value)});const v=async()=>{const o=u.params.id;try{if(!(await fetch(`/api/admin/user/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s.value)})).ok)throw new Error("Failed to update user");b.push("/admin/users")}catch(e){console.error("Error updating user:",e)}};return(o,e)=>{const a=g("RouterLink");return r(),k(j,null,{default:p(()=>[l(d)?(r(),c("div",B,"Loading...")):(r(),c("div",E,[t("form",{onSubmit:_(v,["prevent"]),class:"w-full"},[t("label",L,[e[3]||(e[3]=t("div",{class:"label"},[t("span",{class:"label-text"},"ชื่อ")],-1)),i(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=n=>l(s).fullname=n),class:"input input-bordered w-full",required:""},null,512),[[f,l(s).fullname]])]),t("label",M,[e[4]||(e[4]=t("div",{class:"label"},[t("span",{class:"label-text"},"อีเมล")],-1)),i(t("input",{type:"email","onUpdate:modelValue":e[1]||(e[1]=n=>l(s).email=n),class:"input input-bordered w-full",required:""},null,512),[[f,l(s).email]])]),t("label",R,[e[6]||(e[6]=t("div",{class:"label"},[t("span",{class:"label-text"},"role")],-1)),i(t("select",{class:"select select-bordered","onUpdate:modelValue":e[2]||(e[2]=n=>l(s).role=n)},e[5]||(e[5]=[t("option",{value:"user"},"User",-1),t("option",{value:"admin"},"Admin",-1),t("option",{value:"cashier"},"Cashier",-1)]),512),[[N,l(s).role]])]),t("div",T,[U(a,{to:"/admin/users",class:"btn btn-accent font-light my-5 text-white sm:w-60 w-36"},{default:p(()=>e[7]||(e[7]=[V(" ย้อนกลับ ")])),_:1}),e[8]||(e[8]=t("div",null,[t("button",{type:"submit",class:"btn btn-accent my-5 text-white font-light sm:w-60 w-36"},"ยืนยันการแก้ไข")],-1))])],32)]))]),_:1})}}};export{A as default};
